import { all, takeLatest, call, put } from "redux-saga/effects";
import actionTypes from "./project.actionTypes";
import { fetchProjectsSuccess, fetchProjectsFailure } from "./project.action";
import API from "API/jsonServer";

const fetchFromAPI = () => API.get("/project");

//fetch all projects
export function* fetchProjects() {
  try {
    const { data } = yield call(fetchFromAPI);
    yield put(fetchProjectsSuccess(data));
  } catch (error) {
    yield put(fetchProjectsFailure(error));
  }
}

export function* onFetchProjectStart() {
  yield takeLatest(actionTypes.FETCH_PROJECTS_START, fetchProjects);
}

export function* projectSagas() {
  yield all([call(onFetchProjectStart)]);
}
