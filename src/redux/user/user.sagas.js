import { all, takeLatest, call, put } from "redux-saga/effects";
import actionTypes from "./user.actionTypes";
import { fetchUsersSuccess, fetchUsersFailure } from "./user.action";
import API from "API/jsonServer";

const fetchFromAPI = () => API.get("/users");

export function* fetchUsers() {
  try {
    const { data } = yield call(fetchFromAPI);
    yield put(fetchUsersSuccess(data));
  } catch (error) {
    yield put(fetchUsersFailure(error));
  }
}

export function* onFetchUsersStart() {
  yield takeLatest(actionTypes.FETCH_USERS_START, fetchUsers);
}

export function* userSagas() {
  yield all([call(onFetchUsersStart)]);
}
